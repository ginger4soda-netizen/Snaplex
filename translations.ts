// --- translations.ts (修复版：先定义词典，再定义函数) ---

// 1. 完整词典 (7 国语言)
export const translations = {
  English: {
    // 通用按钮
    btnBack: "Back",
    btnSave: "Save Settings",
    btnCamera: "Snap a Shot",
    btnUpload: "Batch Upload",
    
    // 首页 (Home)
    homeTitle: "Snap & Learn",
    homeSubtitle: "Snap to Decode. Learn to Create.",
    errCamera: "Could not access camera. Please allow permissions or use Batch Upload.",
    
    // 历史页 (History)
    libraryTitle: "Your Library",
    searchPlaceholder: "Search snaps (e.g., 'red', 'close-up')...",
    btnFind: "Find",
    btnSelect: "Select",
    btnCancel: "Cancel",
    btnSelectAll: "Select All",
    btnDeselectAll: "Deselect All",
    btnSelectNew: "Select New",
    txtSelected: "selected",
    btnExport: "Export",
    btnDelete: "Delete",
    emptyHistory: "No history yet. Snap a shot!",
    noMatches: "No matches found.",
    sectionNew: "New Snaps",
    sectionExported: "Exported Library",
    confirmDelete: "Delete these items?",

    // 设置页 (Settings)
    settingsTitle: "Personalize",
    lblCopyConfig: "\"Copy All\" Configuration",
    lblLangSettings: "Language Settings",
    lblSystemLang: "App System Language",
    lblFrontLang: "Card Front Language",
    lblBackLang: "Card Back Language",
    lblStylePref: "Style Preferences",
    styleStandard: "Standard",
    styleArtistic: "Artistic",
    styleCinematic: "Cinematic",
    styleTechnical: "Technical",
    styleUIUX: "UI/UX",
    styleLiterary: "Literary",

    // 分析页 (AnalysisView)
    tabAnalysis: "Analysis",
    tabChat: "Chat",
    btnCopyAll: "Copy All",
    msgCopiedConfig: "Copied configured translated prompts!",
    msgCopied: "Copied configured prompts!",
    msgImgCopied: "Image copied to clipboard!",
    msgImgFail: "Failed to copy image.",
    transUnavailable: "Translation unavailable.",
    // 模块标题
    lblSubject: "SUBJECT",
    lblEnvironment: "ENVIRONMENT",
    lblComposition: "COMPOSITION",
    lblLighting: "LIGHTING",
    lblMood: "MOOD",
    lblStyle: "STYLE",
    lblDescription: "DESCRIPTION",

    // 聊天 (ChatBot)
    chatGreeting: "What else do you want to know about this image?",
    chatPlaceholder: "Ask something...",
    chatThinking: "AI is thinking...",

    // 等待页 (Loader)
    loaderTitle: "Visual Decoding...",
    loaderSubtitle: "Learn visual terms while waiting.",
    loaderDone: "Decoding Complete",
    btnView: "View Result",
  },
  
  Chinese: {
    btnBack: "返回",
    btnSave: "保存设置",
    btnCamera: "拍照",
    btnUpload: "上传",
    homeTitle: "拍 · 学",
    homeSubtitle: "拍照解码视觉，学习创作灵感",
    errCamera: "无法访问相机，请允许权限或使用批量上传。",
    libraryTitle: "我的图库",
    searchPlaceholder: "搜索 (如：红色、特写)...",
    btnFind: "搜索",
    btnSelect: "选择",
    btnCancel: "取消",
    btnSelectAll: "全选",
    btnDeselectAll: "取消全选",
    btnSelectNew: "选择未导出",
    txtSelected: "项已选",
    btnExport: "导出表单",
    btnDelete: "删除",
    emptyHistory: "暂无记录，快去拍一张吧！",
    noMatches: "没有找到匹配的图片。",
    sectionNew: "新上传",
    sectionExported: "已归档",
    confirmDelete: "确定删除这些图片吗？",
    settingsTitle: "个性化设置",
    lblCopyConfig: "“一键复制”配置",
    lblLangSettings: "语言设置",
    lblSystemLang: "App界面语言",
    lblFrontLang: "卡片正面语言",
    lblBackLang: "卡片背面语言",
    lblStylePref: "风格偏好",
    styleStandard: "标准",
    styleArtistic: "艺术",
    styleCinematic: "影视",
    styleTechnical: "技术",
    styleUIUX: "UI/UX",
    styleLiterary: "文学",
    tabAnalysis: "分析结果",
    tabChat: "AI对话",
    btnCopyAll: "一键复制",
    msgCopiedConfig: "已复制配置的译文提示词！",
    msgCopied: "已复制配置的提示词！",
    msgImgCopied: "图片已复制到剪贴板！",
    msgImgFail: "图片复制失败。",
    transUnavailable: "暂无翻译。",
    lblSubject: "主体",
    lblEnvironment: "环境",
    lblComposition: "构图",
    lblLighting: "光影/色彩",
    lblMood: "情绪/氛围",
    lblStyle: "美学风格",
    lblDescription: "描述",
    chatGreeting: "对这张图你还有什么想了解的？",
    chatPlaceholder: "输入你的问题...",
    chatThinking: "AI 思考中...",
    loaderTitle: "视觉解码中...",
    loaderSubtitle: "等待时学点词条吧",
    loaderDone: "解码完成",
    btnView: "查看结果",
  },

  Spanish: {
    btnBack: "Volver", btnSave: "Guardar", btnCamera: "Tomar Foto", btnUpload: "Subir",
    homeTitle: "Captura y Aprende", homeSubtitle: "Captura para decodificar. Aprende a crear.",
    errCamera: "No se puede acceder a la cámara. Permita permisos o use Subir.",
    libraryTitle: "Tu Biblioteca", searchPlaceholder: "Buscar (ej. rojo, primer plano)...", btnFind: "Buscar",
    btnSelect: "Seleccionar", btnCancel: "Cancelar", btnSelectAll: "Todo", btnDeselectAll: "Nada",
    btnSelectNew: "Nuevos", txtSelected: "seleccionado", btnExport: "Exportar", btnDelete: "Eliminar",
    emptyHistory: "Sin historial. ¡Toma una foto!", noMatches: "No se encontraron coincidencias.",
    sectionNew: "Nuevas Fotos", sectionExported: "Biblioteca Exportada", confirmDelete: "¿Eliminar estos elementos?",
    settingsTitle: "Personalizar", lblCopyConfig: "Configuración de Copia", lblLangSettings: "Configuración de Idioma",
    lblSystemLang: "Idioma del Sistema", lblFrontLang: "Idioma Frontal", lblBackLang: "Idioma Dorsal",
    lblStylePref: "Preferencias de Estilo", styleStandard: "Estándar", styleArtistic: "Artístico",
    styleCinematic: "Cinematográfico", styleTechnical: "Técnico", styleUIUX: "UI/UX", styleLiterary: "Literario",
    tabAnalysis: "Análisis", tabChat: "Chat", btnCopyAll: "Copiar Todo",
    msgCopiedConfig: "¡Prompts traducidos copiados!", msgCopied: "¡Prompts copiados!",
    msgImgCopied: "¡Imagen copiada!", msgImgFail: "Fallo al copiar imagen.", transUnavailable: "Traducción no disponible.",
    lblSubject: "SUJETO", lblEnvironment: "ENTORNO", lblComposition: "COMPOSICIÓN",
    lblLighting: "ILUMINACIÓN/COLOR", lblMood: "ESTADO DE ÁNIMO/VIBRA", lblStyle: "ESTILO ESTÉTICO", lblDescription: "DESCRIPCIÓN",
    chatGreeting: "¿Qué más quieres saber sobre esta imagen?", chatPlaceholder: "Pregunta algo...", chatThinking: "IA pensando...",
    loaderTitle: "Decodificación Visual...", loaderSubtitle: "Aprende estilos mientras esperas.",
    loaderDone: "Decodificación Completa", btnView: "Ver Resultado",
  },

  Japanese: {
    btnBack: "戻る", btnSave: "保存", btnCamera: "写真を撮る", btnUpload: "アップロード",
    homeTitle: "スナップ＆ラーン", homeSubtitle: "撮影して解読。創造を学ぶ。",
    errCamera: "カメラにアクセスできません。許可するか、アップロードを使用してください。",
    libraryTitle: "ライブラリ", searchPlaceholder: "検索 (例: 赤、クローズアップ)...", btnFind: "検索",
    btnSelect: "選択", btnCancel: "キャンセル", btnSelectAll: "すべて", btnDeselectAll: "解除",
    btnSelectNew: "新規のみ", txtSelected: "選択済み", btnExport: "エクスポート", btnDelete: "削除",
    emptyHistory: "履歴なし。写真を撮りましょう！", noMatches: "見つかりません。",
    sectionNew: "新しいスナップ", sectionExported: "エクスポート済み", confirmDelete: "これらを削除しますか？",
    settingsTitle: "パーソナライズ", lblCopyConfig: "「全コピー」設定", lblLangSettings: "言語設定",
    lblSystemLang: "システム言語", lblFrontLang: "カード表面言語", lblBackLang: "カード裏面言語",
    lblStylePref: "スタイル設定", styleStandard: "標準", styleArtistic: "芸術的",
    styleCinematic: "映画的", styleTechnical: "技術的", styleUIUX: "UI/UX", styleLiterary: "文学的",
    tabAnalysis: "分析", tabChat: "チャット", btnCopyAll: "すべてコピー",
    msgCopiedConfig: "翻訳されたプロンプトをコピーしました！", msgCopied: "プロンプトをコピーしました！",
    msgImgCopied: "画像をコピーしました！", msgImgFail: "画像のコピーに失敗しました。", transUnavailable: "翻訳なし。",
    lblSubject: "主題", lblEnvironment: "環境", lblComposition: "構図",
    lblLighting: "照明/色彩", lblMood: "ムード/雰囲気", lblStyle: "美的スタイル", lblDescription: "説明",
    chatGreeting: "この画像について他に知りたいことは？", chatPlaceholder: "質問を入力...", chatThinking: "AI思考中...",
    loaderTitle: "視覚的解読中...", loaderSubtitle: "待機中にスタイルを学ぶ",
    loaderDone: "解読完了", btnView: "結果を見る",
  },

  French: {
    btnBack: "Retour", btnSave: "Enregistrer", btnCamera: "Prendre une Photo", btnUpload: "Upload",
    homeTitle: "Capturer & Apprendre", homeSubtitle: "Capturer pour décoder. Apprendre à créer.",
    errCamera: "Impossible d'accéder à la caméra. Autorisez l'accès ou utilisez l'Upload.",
    libraryTitle: "Votre Bibliothèque", searchPlaceholder: "Rechercher (ex: rouge, gros plan)...", btnFind: "Trouver",
    btnSelect: "Sélectionner", btnCancel: "Annuler", btnSelectAll: "Tout", btnDeselectAll: "Rien",
    btnSelectNew: "Nouveaux", txtSelected: "sélectionné", btnExport: "Exporter", btnDelete: "Supprimer",
    emptyHistory: "Pas d'historique. Prenez une photo !", noMatches: "Aucun résultat.",
    sectionNew: "Nouveaux Snaps", sectionExported: "Bibliothèque exportée", confirmDelete: "Supprimer ces éléments ?",
    settingsTitle: "Personnaliser", lblCopyConfig: "Config. Copier Tout", lblLangSettings: "Paramètres de Langue",
    lblSystemLang: "Langue Système", lblFrontLang: "Langue Recto", lblBackLang: "Langue Verso",
    lblStylePref: "Préférences de Style", styleStandard: "Standard", styleArtistic: "Artistique",
    styleCinematic: "Cinématographique", styleTechnical: "Technique", styleUIUX: "UI/UX", styleLiterary: "Littéraire",
    tabAnalysis: "Analyse", tabChat: "Chat", btnCopyAll: "Copier Tout",
    msgCopiedConfig: "Prompts traduits copiés !", msgCopied: "Prompts copiés !",
    msgImgCopied: "Image copiée !", msgImgFail: "Échec de la copie.", transUnavailable: "Traduction indisponible.",
    lblSubject: "SUJET", lblEnvironment: "ENVIRONNEMENT", lblComposition: "COMPOSITION",
    lblLighting: "ÉCLAIRAGE/COULEUR", lblMood: "AMBIANCE/VIBE", lblStyle: "STYLE ESTHÉTIQUE", lblDescription: "DESCRIPTION",
    chatGreeting: "Que voulez-vous savoir d'autre ?", chatPlaceholder: "Posez une question...", chatThinking: "L'IA réfléchit...",
    loaderTitle: "Décodage Visuel...", loaderSubtitle: "Apprenez des styles en attendant.",
    loaderDone: "Décodage Terminé", btnView: "Voir le Résultat",
  },

  German: {
    btnBack: "Zurück", btnSave: "Speichern", btnCamera: "Schnappschuss", btnUpload: "Upload",
    homeTitle: "Knipsen & Lernen", homeSubtitle: "Knipsen zum Dekodieren. Lernen zu Erstellen.",
    errCamera: "Kamera nicht verfügbar. Bitte Berechtigungen prüfen oder Upload nutzen.",
    libraryTitle: "Deine Bibliothek", searchPlaceholder: "Suchen (z.B. Rot, Nahaufnahme)...", btnFind: "Finden",
    btnSelect: "Wählen", btnCancel: "Abbrechen", btnSelectAll: "Alle", btnDeselectAll: "Keine",
    btnSelectNew: "Neue", txtSelected: "ausgewählt", btnExport: "Exportieren", btnDelete: "Löschen",
    emptyHistory: "Kein Verlauf. Mach einen Schnappschuss!", noMatches: "Kein Treffer.",
    sectionNew: "Neue Snaps", sectionExported: "Archiv", confirmDelete: "Diese Elemente löschen?",
    settingsTitle: "Personalisieren", lblCopyConfig: "Konfig. Alles Kopieren", lblLangSettings: "Spracheinstellungen",
    lblSystemLang: "Systemsprache", lblFrontLang: "Vorderseite Sprache", lblBackLang: "Rückseite Sprache",
    lblStylePref: "Stil-Präferenzen", styleStandard: "Standard", styleArtistic: "Künstlerisch",
    styleCinematic: "Filmisch", styleTechnical: "Technisch", styleUIUX: "UI/UX", styleLiterary: "Literarisch",
    tabAnalysis: "Analyse", tabChat: "Chat", btnCopyAll: "Alles Kopieren",
    msgCopiedConfig: "Übersetzte Prompts kopiert!", msgCopied: "Prompts kopiert!",
    msgImgCopied: "Bild kopiert!", msgImgFail: "Kopieren fehlgeschlagen.", transUnavailable: "Keine Übersetzung.",
    lblSubject: "SUBJEKT", lblEnvironment: "UMGEBUNG", lblComposition: "KOMPOSITION",
    lblLighting: "BELEUCHTUNG/FARBE", lblMood: "STIMMUNG/VIBE", lblStyle: "ÄSTHETISCHER STIL", lblDescription: "BESCHREIBUNG",
    chatGreeting: "Was möchtest du noch wissen?", chatPlaceholder: "Stelle eine Frage...", chatThinking: "KI denkt nach...",
    loaderTitle: "Visuelle Dekodierung...", loaderSubtitle: "Lerne Stile beim Warten.",
    loaderDone: "Dekodierung Abgeschlossen", btnView: "Ergebnis Ansehen",
  },

  Korean: {
    btnBack: "뒤로", btnSave: "저장", btnCamera: "스냅 촬영", btnUpload: "업로드",
    homeTitle: "스냅 & 러닝", homeSubtitle: "찍어서 해독하고, 만들며 배웁니다.",
    errCamera: "카메라에 접근할 수 없습니다. 권한을 허용하거나 업로드를 사용하세요.",
    libraryTitle: "라이브러리", searchPlaceholder: "검색 (예: 빨강, 클로즈업)...", btnFind: "검색",
    btnSelect: "선택", btnCancel: "취소", btnSelectAll: "전체", btnDeselectAll: "해제",
    btnSelectNew: "새 항목", txtSelected: "선택됨", btnExport: "내보내기", btnDelete: "삭제",
    emptyHistory: "기록이 없습니다. 스냅을 찍어보세요!", noMatches: "결과 없음.",
    sectionNew: "새로운 스냅", sectionExported: "보관함", confirmDelete: "삭제하시겠습니까?",
    settingsTitle: "개인화", lblCopyConfig: "전체 복사 설정", lblLangSettings: "언어 설정",
    lblSystemLang: "앱 시스템 언어", lblFrontLang: "카드 앞면 언어", lblBackLang: "카드 뒷면 언어",
    lblStylePref: "스타일 환경설정", styleStandard: "표준", styleArtistic: "예술적",
    styleCinematic: "영화적", styleTechnical: "기술적", styleUIUX: "UI/UX", styleLiterary: "문학적",
    tabAnalysis: "분석", tabChat: "채팅", btnCopyAll: "전체 복사",
    msgCopiedConfig: "번역된 프롬프트 복사됨!", msgCopied: "프롬프트 복사됨!",
    msgImgCopied: "이미지 복사됨!", msgImgFail: "이미지 복사 실패.", transUnavailable: "번역 없음.",
    lblSubject: "주제", lblEnvironment: "환경", lblComposition: "구도",
    lblLighting: "조명/색상", lblMood: "무드/분위기", lblStyle: "미적 스타일", lblDescription: "설명",
    chatGreeting: "이 이미지에 대해 더 알고 싶은 것이 있나요?", chatPlaceholder: "질문하세요...", chatThinking: "AI 생각 중...",
    loaderTitle: "시각적 해독 중...", loaderSubtitle: "기다리는 동안 스타일 배우기",
    loaderDone: "해독 완료", btnView: "결과 보기",
  }
};

// 2. 智能匹配助手 (放在后面，确保 translations 已定义)
export const getTranslation = (langString: string | undefined) => {
  if (!langString) return translations.English;
  const key = langString.split(' ')[0]; // 例如 "Chinese (中文)" -> "Chinese"
  return (translations as any)[key] || translations.English;
};